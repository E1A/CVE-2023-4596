# CVE-2023-4596
PoC Script for CVE-2023-4596, unauthenticated Remote Command Execution through arbitrary file uploads.
<br>
<br>
[Nuclei Template](https://github.com/projectdiscovery/nuclei-templates/pull/8118/files)
<br>
[WordFence](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/forminator/forminator-1246-unauthenticated-arbitrary-file-upload)
<br>

# Summary
A severe security vulnerability has been discovered within Forminator, which enables a unauthorized attackers to upload arbitrary files to the targeted server. The initial proof of concept (PoC) was poorly constructed and lacked clarity. So I developed a Python script for it, the original researcher shared a few unclear screenshots along with a request containing unexplained code.

The vulnerability cause is from an error in the validation process for file types. When attempting to upload a prohibited file format, such as PHP, an alert is generated stating that the "Uploaded file's extension is not allowed." Despite this notification, the uploaded file is not blocked; rather, it is successfully uploaded and can be accessed within the "/wp-content/uploads" folder of the site. This vulnerability has the potential to lead to remote code execution.

Forminator is currently active on more than 400,000 sites, and with the simplicity of the vulnerability, it is quite easy to gain control over any site running Forminator.

# Usage
Find a page running Forminator <= 1.24.6 with an upload function on the page. Copy the full URL and generate an interactsh link, files will be uploaded in /wp-content/uploads/[current year]/[current month]/file.php. 
After a succesful upload, a request should apair in interactsh within 5 seconds, indicating it is vulnerable. The code can be easily modified to create an RCE, but to prevent skiddies from misusing the poc, I've only made an intrusive way to confirm a vulnerable instance.
```
user@debian:~$ python3 exploit.py -u http://127.0.0.1:8000/?p=7
Input interactsh link: <input interactsh link>

[+] Sending payload to target
[+] Successful file upload!

Uploaded File Location: http://127.0.0.1:8000/wp-content/uploads/2023/08/ping.php

[+] Sending request to uploaded file...
[+] Successfully triggerd the uploaded file!
[+] Check Interactsh for an incoming request.
```

## Installation
1. cd CVE-2023-4596/ && docker compose -f - up 
2. Browse to http://127.0.0.1:8000
3. Set up a wp account and download the vulnerable plugin found [here](https://downloads.wordpress.org/plugin/forminator.1.24.6.zip)
4. Enjoy

## Disclaimer
The script provided is for educational purposes only, I am not responsible for your actions.
